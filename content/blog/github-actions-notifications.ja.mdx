---
title: "午後3時「すべてが壊れた」瞬間：GitHub Actions通知を修正した方法"
description: "デプロイが何時間も失敗していたことに気づいた時の沈む気持ち？Echobellでインスタント GitHub Actions 失敗通知を設定し、二度と壊れたビルドを見逃さない方法を紹介します。"
date: 2025-04-26
author: Nooc
authorAvatarLink: /images/avatars/nooc.webp
authorLink: https://nooc.me
---

# 午後3時「すべてが壊れた」瞬間：GitHub Actions通知を修正した方法

火曜日の午後3時47分、胃が沈むSlackメッセージを受け取りました：*「今朝からデプロイが失敗し続けているけど、知ってた？」*

いいえ。知りませんでした。

メインブランチが**6時間**も壊れていて、デプロイをブロックし、チーム全体をイライラさせていました。GitHub Actionsの失敗通知は？ニュースレターや会議招待の山に埋もれて、メール受信箱のどこかにありました。

その日、通知の混乱のせいで重要なCI/CD失敗を見逃すことは**二度とない**と決めました。Echobellでどう解決したか、そしてあなたもどうできるかを紹介します。

## ビルド失敗を見逃す本当のコスト

GitHub Actionsの失敗を見逃すとき何が起こるか（痛い経験から）：

### 時間泥棒
- **発見の遅れ**：壊れたビルドに気づくまで数時間が経過
- **コンテキストスイッチング**：失敗に気づいたときには新しい作業に深く集中している
- **調査時間**：何が壊れ、いつ壊れたかを理解する
- **修正の複雑化**：単純な失敗が他の変更と混じって複雑になる

### チームへの影響
- **デプロイのブロック**：パイプラインが修正されるまで機能が積み上がる
- **開発者のフラストレーション**：チームメンバーがPRをマージしたりアップデートをリリースできない
- **顧客への影響**：誰も理由を知らないまま、バグ修正と機能がが遅延

**残酷な真実？** CI/CDの失敗を見逃すことで、インシデントごとに約2-3時間の集団生産性をチームが失うと計算しました。そして、認めたくないほど頻繁に起こります。

## GitHub Actions通知をどう修正したか（簡単な方法）

その災難の火曜日の後、Echobellで適切なGitHub Actions通知を設定するのにちょうど15分かかりました。それ以来チームの正気を救い続けている正確な設定がこちら：

### ステップ1：「ビルド失敗」チャンネルを作成

1. **Echobellを開いて**新しいチャンネルを作成
2. **わかりやすく名前をつける**「🚨 CI/CDエラー」（絵文字は素早い認識に役立つ）
3. **赤色を選ぶ**（失敗には緊急性が必要だから）
4. **実際に役立つ通知テンプレートを設定**：

```
タイトル：🚨 {{workflow}}が{{branch}}で失敗
本文：リポ: {{repository}} | 実行: {{run_number}} | 確認: {{run_url}}
```
name: Build and Test

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Build
        run: npm run build

      - name: Test
        run: npm test

      - name: Notify on Failure
        if: failure()
        uses: weelone/echobell-action@v1
        with:
          webhook-url: ${{ secrets.ECHOBELL_WEBHOOK_URL }}
```

### 複数ジョブの workflow の高度な設定

複数の依存ジョブを持つより複雑なパイプラインでは、どの部分が失敗したのかを正確に知りたいでしょう。これは、前のジョブの*いずれか*が失敗した場合に実行される専用の通知ジョブを追加することで実現できます：

```yaml
name: Deploy Pipeline

on:
  push:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Run Tests
        run: npm test

  build:
    needs: test
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Build
        run: npm run build

  deploy:
    needs: build
    runs-on: ubuntu-latest
    steps:
      - name: Deploy
        run: ./deploy.sh

  notify_on_failure:
    runs-on: ubuntu-latest
    needs: [test, build, deploy]
    if: failure()
    steps:
      - name: Send Failure Notification
        uses: weelone/echobell-action@v1
        with:
          webhook-url: ${{ secrets.ECHOBELL_WEBHOOK_URL }}
```

## Echobell Webhook の設定

固有の webhook URL を取得するのは簡単です：

1.  iOS 用 Echobell アプリをダウンロードして登録します。
2.  アプリ内で、新しい通知チャンネルを作成します。
3.  そのチャンネル用に生成された webhook URL をコピーします。
4.  GitHub リポジトリで、`Settings` > `Secrets and variables` > `Actions` に移動します。
5.  `ECHOBELL_WEBHOOK_URL` という名前の新しいリポジトリシークレットを作成し、コピーした URL を貼り付けます。

## 効果的な通知のためのヒント

失敗アラートをさらに便利にするには：

1.  **`if: failure()` を使用する**：通知が _実際に_ 何かが間違っている場合 _のみ_ 送信されるようにします。複数の job を持つ workflow の場合は、`if: failure()` と、重要な job すべてを指す `needs` を使用した専用の最終 job を使用します。
2.  **わかりやすいタイトル**：リポジトリと障害が発生したことを明確に示します（例：「`your-repo` CI の失敗」）。
3.  **コンテキストを提供する**：迅速なアクセスのために、メッセージ本文に workflow 名と特定の GitHub Actions 実行への直接リンクを含めます。
4.  **優先度を考慮する**：Echobell では優先度の設定が可能です；必要に応じて、重要なデプロイ失敗には高い優先度を使用します（アクションの `priority` 入力を介して）。

## 結論

Echobell と GitHub Actions を統合することで、CI/CD パイプラインの失敗について、あなたとチームに即座に通知されることを保証し、安心感を提供します。セットアップは迅速で、通知は即時、そしてより効率的で応答性の高い開発プロセスを維持するのに役立ちます。

workflow の失敗を見逃さないようにしましょう。今日から Echobell 通知アクションを試して、プロジェクトを順調に進めましょう。
