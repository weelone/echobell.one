---
title: Home Assistant Integration
description: Vollst√§ndige Anleitung zur Integration von Echobell in Home Assistant f√ºr sofortige Smart-Home-Benachrichtigungen und Alarme
---

# Home Assistant Integration

[Home Assistant](https://www.home-assistant.io/) ist eine leistungsstarke Open-Source-Plattform f√ºr die Hausautomation, bei der lokale Steuerung und Privatsph√§re an erster Stelle stehen. Durch die Integration von Echobell in Home Assistant k√∂nnen Sie sofortige Benachrichtigungen und sogar Telefonanrufe erhalten, wenn wichtige Ereignisse in Ihrem Smart Home auftreten ‚Äì sei es ein Sicherheitsalarm, eine Temperatur√ºberschreitung oder ein Automatisierungsausl√∂ser.

Diese Anleitung f√ºhrt Sie durch die Einrichtung von Echobell, um Benachrichtigungen von Ihren Home Assistant-Automatisierungen √ºber Webhooks oder den RESTful Notify-Dienst zu erhalten.

## Voraussetzungen

Bevor Sie beginnen, stellen Sie sicher, dass Sie Folgendes haben:

- [Echobell App](https://apps.apple.com/app/id6743597198) auf Ihrem iOS-Ger√§t installiert
- Einen aktiven Echobell-Kanal (erstellen Sie einen in der App, falls noch nicht geschehen)
- Eine laufende Home Assistant-Instanz (Version 2023.1 oder neuer empfohlen)
- Zugriff auf Ihre Home Assistant-Konfiguration

## Methode 1: Verwendung von Webhook-Triggern (Empfohlen)

Die Webhook-Methode ist der flexibelste Ansatz, der es Ihnen erm√∂glicht, benutzerdefinierte Daten zu senden und [Template-Variablen](/docs/template) in Ihren Benachrichtigungen zu verwenden.

### Schritt 1: Ihre Echobell Webhook-URL abrufen

1. √ñffnen Sie die Echobell-App und navigieren Sie zu Ihrem Kanal
2. Tippen Sie auf den Kanal, um die Details anzuzeigen
3. Finden Sie die **Webhook-URL** im Abschnitt "Triggers"
4. Kopieren Sie die URL ‚Äì sie sieht so aus: `https://hook.echobell.one/t/IHR_TOKEN`

### Schritt 2: Eine Home Assistant-Automatisierung erstellen

In Home Assistant k√∂nnen Sie Echobell-Benachrichtigungen mit dem Dienst `rest_command` ausl√∂sen. F√ºgen Sie zun√§chst den REST-Befehl zu Ihrer `configuration.yaml` hinzu:

```yaml
rest_command:
  echobell_notify:
    url: "https://hook.echobell.one/t/YOUR_TOKEN"
    method: POST
    content_type: "application/json"
    payload: '{"title": "{{ title }}", "message": "{{ message }}"}'
```

Ersetzen Sie `YOUR_TOKEN` durch Ihr tats√§chliches Echobell-Webhook-Token.

Starten Sie Home Assistant nach dem Hinzuf√ºgen neu, um die neue Konfiguration zu laden.

### Schritt 3: Verwendung in Automatisierungen

Jetzt k√∂nnen Sie diesen Dienst von jeder Automatisierung aus aufrufen. Hier ist ein Beispiel, das Sie benachrichtigt, wenn eine T√ºr ge√∂ffnet wird:

```yaml
automation:
  - alias: "Door Open Alert"
    trigger:
      - platform: state
        entity_id: binary_sensor.front_door
        to: "on"
    action:
      - service: rest_command.echobell_notify
        data:
          title: "Security Alert"
          message: "Front door opened at {{ now().strftime('%H:%M') }}"
```

### Schritt 4: Benachrichtigungsvorlagen konfigurieren

Konfigurieren Sie in Ihren Echobell-Kanaleinstellungen die Benachrichtigungsvorlagen, um die Webhook-Daten anzuzeigen:

- **Titel-Vorlage**: `{{title}}`
- **Inhalt-Vorlage**: `{{message}}`

Wenn die Automatisierung nun ausgel√∂st wird, erhalten Sie eine Benachrichtigung mit dem benutzerdefinierten Titel und der Nachricht.

## Methode 2: Verwendung der RESTful Notify-Plattform

F√ºr einen st√§rker integrierten Ansatz k√∂nnen Sie Echobell als Benachrichtigungsdienst (Notify Service) in Home Assistant einrichten.

### Konfiguration

F√ºgen Sie Folgendes zu Ihrer `configuration.yaml` hinzu:

```yaml
notify:
  - name: echobell
    platform: rest
    resource: https://hook.echobell.one/t/YOUR_TOKEN
    method: POST_JSON
    data:
      title: "{{ title }}"
      message: "{{ message }}"
```

Ersetzen Sie `YOUR_TOKEN` durch Ihr Echobell-Webhook-Token und starten Sie dann Home Assistant neu.

### Verwendung des Notify-Dienstes

Jetzt k√∂nnen Sie Echobell wie jeden anderen Benachrichtigungsdienst verwenden:

```yaml
automation:
  - alias: "Low Battery Alert"
    trigger:
      - platform: numeric_state
        entity_id: sensor.phone_battery
        below: 20
    action:
      - service: notify.echobell
        data:
          title: "Low Battery Warning"
          message: "Phone battery is at {{ states('sensor.phone_battery') }}%"
```

## Erweiterte Anwendungsf√§lle

### Temperatur√ºberwachung mit kritischen Alarmen

Verwenden Sie [Benachrichtigungstypen](/docs/notification), um kritische Temperaturalarme als Anrufe zu senden:

```yaml
rest_command:
  echobell_critical:
    url: "https://hook.echobell.one/t/YOUR_TOKEN"
    method: POST
    content_type: "application/json"
    payload: '{"temperature": "{{ temperature }}", "location": "{{ location }}", "severity": "critical"}'
```

Stellen Sie in Ihrem Echobell-Kanal den [Benachrichtigungstyp](/docs/notification) auf "Calling" (Anruf) und verwenden Sie diese Vorlage:

- **Titel**: `Critical Temperature Alert`
- **Inhalt**: `{{location}} temperature is {{temperature}}¬∞C - Immediate attention required!`

### Integration von Sicherheitssystemen

Richten Sie eine umfassende Sicherheits√ºberwachung ein:

```yaml
automation:
  - alias: "Security Breach Detection"
    trigger:
      - platform: state
        entity_id:
          - binary_sensor.motion_detector_1
          - binary_sensor.motion_detector_2
          - binary_sensor.window_sensor
        to: "on"
    condition:
      - condition: state
        entity_id: alarm_control_panel.home_alarm
        state: "armed_away"
    action:
      - service: rest_command.echobell_notify
        data:
          title: "üö® Security Alert"
          message: "{{ trigger.to_state.attributes.friendly_name }} detected activity while system armed"
          sensor: "{{ trigger.entity_id }}"
          timestamp: "{{ now().isoformat() }}"
```

### Benachrichtigungen f√ºr intelligente Haushaltsger√§te

√úberwachen Sie Ger√§tezyklen und lassen Sie sich benachrichtigen, wenn diese abgeschlossen sind:

```yaml
automation:
  - alias: "Washing Machine Complete"
    trigger:
      - platform: state
        entity_id: sensor.washing_machine_power
        to: "0"
        for:
          minutes: 3
    action:
      - service: notify.echobell
        data:
          title: "Washing Machine Done"
          message: "Your laundry is ready to be moved to the dryer"
```

### Umwelt√ºberwachung

Verfolgen Sie Luftqualit√§t, Luftfeuchtigkeit oder andere Umweltfaktoren:

```yaml
automation:
  - alias: "High CO2 Alert"
    trigger:
      - platform: numeric_state
        entity_id: sensor.living_room_co2
        above: 1000
    action:
      - service: rest_command.echobell_notify
        data:
          title: "Air Quality Warning"
          message: "CO2 level in living room is {{ states('sensor.living_room_co2') }} ppm. Consider ventilating."
```

## Verwendung von Bedingungen f√ºr intelligentes Filtern

Sie k√∂nnen [Echobell-Bedingungen](/docs/conditions) verwenden, um Benachrichtigungen basierend auf bestimmten Kriterien zu filtern. Zum Beispiel nur zu bestimmten Zeiten benachrichtigen oder wenn Werte Schwellenwerte √ºberschreiten:

Legen Sie eine Bedingung in Ihrem Echobell-Kanal fest:
```
severity == "critical" || (hour >= 22 || hour <= 7)
```

Dies sendet nur Benachrichtigungen, wenn der Schweregrad kritisch ist ODER wenn es Nacht ist (22 Uhr bis 7 Uhr).

F√ºgen Sie in Ihrer Home Assistant-Automatisierung die relevanten Daten hinzu:

```yaml
action:
  - service: rest_command.echobell_notify
    data:
      title: "Temperature Alert"
      message: "Freezer temperature: {{ states('sensor.freezer_temp') }}¬∞C"
      severity: "{% if states('sensor.freezer_temp') | float > -10 %}critical{% else %}normal{% endif %}"
      hour: "{{ now().hour }}"
```

## Senden von Sensordaten

Sie k√∂nnen beliebige Home Assistant-Sensordaten an Ihre Echobell-Benachrichtigungen √ºbergeben:

```yaml
rest_command:
  echobell_sensor_update:
    url: "https://hook.echobell.one/t/YOUR_TOKEN"
    method: POST
    content_type: "application/json"
    payload: >
      {
        "sensor_name": "{{ sensor_name }}",
        "current_value": "{{ current_value }}",
        "unit": "{{ unit }}",
        "state": "{{ state }}",
        "timestamp": "{{ timestamp }}"
      }
```

## Umgang mit HTTP-Headern

Echobell kann auf HTTP-Header von Webhook-Anfragen zugreifen. Dies ist n√ºtzlich f√ºr die Authentifizierung oder Nachverfolgung:

```yaml
rest_command:
  echobell_with_headers:
    url: "https://hook.echobell.one/t/YOUR_TOKEN"
    method: POST
    headers:
      X-Home-Assistant-Instance: "{{ instance_name }}"
      X-Automation-ID: "{{ automation_id }}"
    content_type: "application/json"
    payload: '{"message": "{{ message }}"}'
```

Greifen Sie in Ihrer Echobell-Vorlage mit folgendem Befehl auf Header zu:
```
{{header["x-home-assistant-instance"]}}
```

## Debugging und Testen

### Testen Sie Ihren Webhook

Verwenden Sie die Entwicklerwerkzeuge ‚Üí Dienste von Home Assistant, um Ihre Konfiguration zu testen:

1. W√§hlen Sie `rest_command.echobell_notify`
2. Geben Sie Testdaten ein:
```yaml
title: "Test Notification"
message: "This is a test from Home Assistant"
```
3. Klicken Sie auf "Dienst ausf√ºhren"
4. √úberpr√ºfen Sie Ihre Echobell-App auf die Benachrichtigung

### Home Assistant-Logs pr√ºfen

Wenn keine Benachrichtigungen ankommen, √ºberpr√ºfen Sie die Home Assistant-Logs:

```bash
# In Home Assistant, gehen Sie zu:
Einstellungen ‚Üí System ‚Üí Protokolle

# Oder pr√ºfen Sie die Log-Datei:
config/home-assistant.log
```

Suchen Sie nach Fehlern im Zusammenhang mit `rest_command` oder HTTP-Anfragen an `hook.echobell.one`.

### Webhook-URL √ºberpr√ºfen

Stellen Sie sicher, dass Ihre Webhook-URL korrekt ist:
- Sie sollte mit `https://hook.echobell.one/t/` beginnen
- Das Token sollte enthalten sein
- Keine zus√§tzlichen Leerzeichen oder Zeichen

## Leistungs√ºberlegungen

### Ratenbegrenzung (Rate Limiting)

Echobell-Webhooks unterliegen einer Ratenbegrenzung, um Missbrauch zu verhindern. F√ºr hochfrequente Sensoren:

- Vermeiden Sie das Ausl√∂sen bei jeder Sensoraktualisierung
- Verwenden Sie `for` in Ausl√∂sern zum Entprellen (Debouncing):
```yaml
trigger:
  - platform: numeric_state
    entity_id: sensor.temperature
    above: 30
    for:
      minutes: 5  # Nur ausl√∂sen nach 5 Minuten √ºber dem Schwellenwert
```

### B√ºndelung von Aktualisierungen

Bei mehreren zusammenh√§ngenden Ereignissen sollten Sie diese in einer einzigen Benachrichtigung b√ºndeln:

```yaml
automation:
  - alias: "Daily Home Summary"
    trigger:
      - platform: time
        at: "09:00:00"
    action:
      - service: rest_command.echobell_notify
        data:
          title: "Morning Home Summary"
          message: >
            Temperature: {{ states('sensor.temperature') }}¬∞C
            Humidity: {{ states('sensor.humidity') }}%
            Energy today: {{ states('sensor.daily_energy') }} kWh
            Windows open: {{ expand(states.binary_sensor) | selectattr('state', 'eq', 'on') | selectattr('attributes.device_class', 'eq', 'window') | list | count }}
```

## Best Practices f√ºr Sicherheit

### Sch√ºtzen Sie Ihre Webhook-URL

- Ver√∂ffentlichen Sie Webhook-URLs niemals in √∂ffentlichen Repositories
- Verwenden Sie Home Assistant Secrets f√ºr sensible Daten
- Rotieren Sie Webhook-Token regelm√§√üig

Verwendung von Secrets in `configuration.yaml`:

```yaml
# secrets.yaml
echobell_webhook: "https://hook.echobell.one/t/YOUR_TOKEN"

# configuration.yaml
rest_command:
  echobell_notify:
    url: !secret echobell_webhook
    method: POST
    content_type: "application/json"
    payload: '{"title": "{{ title }}", "message": "{{ message }}"}'
```

### Sensible Informationen begrenzen

Seien Sie vorsichtig, welche Daten Sie in Benachrichtigungen aufnehmen:

```yaml
# Gut - Allgemeine Informationen
message: "Motion detected in living room"

# Vermeiden - Sensible Details
message: "Security code: 1234, camera feed: http://..."
```

## Fehlerbehebung bei h√§ufigen Problemen

### Benachrichtigungen kommen nicht an

1. **Netzwerkverbindung pr√ºfen**: Stellen Sie sicher, dass Ihre Home Assistant-Instanz das Internet erreichen kann
2. **Webhook-URL verifizieren**: Kopieren Sie sie sorgf√§ltig, einschlie√ülich des Tokens
3. **Echobell-App pr√ºfen**: Stellen Sie sicher, dass Sie den Kanal abonniert haben
4. **Home Assistant-Logs pr√ºfen**: Suchen Sie nach HTTP-Fehlern oder Zeit√ºberschreitungen

### Vorlagenfehler

Wenn Vorlagen nicht korrekt gerendert werden:

1. Testen Sie Vorlagen in Entwicklerwerkzeuge ‚Üí Vorlage
2. Stellen Sie sicher, dass die Variablennamen zwischen Home Assistant und Echobell √ºbereinstimmen
3. Pr√ºfen Sie auf Tippfehler in der Vorlagensyntax: `{{variable}}` nicht `{{ variable}}`

### Automatisierung wird nicht ausgel√∂st

1. √úberpr√ºfen Sie die Ausl√∂sebedingungen in Home Assistant
2. Testen Sie die Automatisierung manuell √ºber die Entwicklerwerkzeuge
3. Pr√ºfen Sie, ob die Entit√§tszust√§nde mit Ihrer Ausl√∂serkonfiguration √ºbereinstimmen
4. √úberpr√ºfen Sie die Automatisierungsspuren (Traces) zur Fehlerbehebung

## Beispiel: Komplettes Sicherheitssystem-Setup

Hier ist ein umfassendes Beispiel, das mehrere Sicherheitssensoren integriert:

```yaml
# configuration.yaml
rest_command:
  echobell_security:
    url: !secret echobell_security_webhook
    method: POST
    content_type: "application/json"
    payload: >
      {
        "event_type": "{{ event_type }}",
        "location": "{{ location }}",
        "sensor": "{{ sensor }}",
        "timestamp": "{{ timestamp }}",
        "alarm_state": "{{ alarm_state }}"
      }

# automations.yaml
- alias: "Security Event Handler"
  trigger:
    - platform: state
      entity_id:
        - binary_sensor.front_door
        - binary_sensor.back_door
        - binary_sensor.garage_door
        - binary_sensor.motion_hallway
        - binary_sensor.motion_living_room
      to: "on"
  action:
    - service: rest_command.echobell_security
      data:
        event_type: "{{ 'door' if 'door' in trigger.entity_id else 'motion' }}"
        location: "{{ trigger.to_state.attributes.friendly_name }}"
        sensor: "{{ trigger.entity_id }}"
        timestamp: "{{ now().strftime('%Y-%m-%d %H:%M:%S') }}"
        alarm_state: "{{ states('alarm_control_panel.home_alarm') }}"
```

Stellen Sie in Echobell Ihre Vorlagen ein:
- **Titel**: `Security Alert: {{event_type | upper}}`
- **Inhalt**: `{{location}} activated at {{timestamp}} (Alarm: {{alarm_state}})`

## N√§chste Schritte

Nachdem Sie Echobell in Home Assistant integriert haben:

- Entdecken Sie [Benachrichtigungstypen](/docs/notification) f√ºr verschiedene Alarmpriorit√§ten
- Erfahren Sie mehr √ºber [Bedingungen](/docs/conditions), um Benachrichtigungen intelligent zu filtern
- Schauen Sie sich [Template-Variablen](/docs/template) f√ºr erweiterte Nachrichtenformatierung an
- Lesen Sie √ºber [Webhook Best Practices](/docs/webhook) f√ºr eine optimale Integration

## Verwandte Ressourcen

- [Home Assistant REST Command Dokumentation](https://www.home-assistant.io/integrations/rest_command/)
- [Home Assistant RESTful Notify Plattform](https://www.home-assistant.io/integrations/notify.rest/)
- [Echobell Webhook Dokumentation](/docs/webhook)
- [Echobell Template System](/docs/template)
