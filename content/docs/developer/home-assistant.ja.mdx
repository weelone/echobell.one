---
title: Home Assistant é€£æº
description: Echobellã¨Home Assistantã‚’é€£æºã—ã€ã‚¹ãƒãƒ¼ãƒˆãƒ›ãƒ¼ãƒ ã®é€šçŸ¥ã‚„ã‚¢ãƒ©ãƒ¼ãƒˆã‚’å³åº§ã«å—ã‘å–ã‚‹ãŸã‚ã®å®Œå…¨ã‚¬ã‚¤ãƒ‰
---

# Home Assistant é€£æº

[Home Assistant](https://www.home-assistant.io/)ã¯ã€ãƒ­ãƒ¼ã‚«ãƒ«åˆ¶å¾¡ã¨ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã‚’ç¬¬ä¸€ã«è€ƒãˆãŸå¼·åŠ›ãªã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã®ãƒ›ãƒ¼ãƒ ã‚ªãƒ¼ãƒˆãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚Echobellã‚’Home Assistantã¨é€£æºã•ã›ã‚‹ã“ã¨ã§ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒ©ãƒ¼ãƒˆã€æ¸©åº¦ã®é–¾å€¤è¶…éã€ã‚ªãƒ¼ãƒˆãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒˆãƒªã‚¬ãƒ¼ãªã©ã€ã‚¹ãƒãƒ¼ãƒˆãƒ›ãƒ¼ãƒ ã§é‡è¦ãªã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç”Ÿã—ãŸéš›ã«ã€å³åº§ã«é€šçŸ¥ã‚„é›»è©±ç€ä¿¡ã‚’å—ã‘å–ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€Webhookã¾ãŸã¯RESTful Notifyã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã€Home Assistantã®ã‚ªãƒ¼ãƒˆãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰Echobellã®é€šçŸ¥ã‚’å—ã‘å–ã‚‹è¨­å®šæ–¹æ³•ã‚’è§£èª¬ã—ã¾ã™ã€‚

## å‰ææ¡ä»¶

å§‹ã‚ã‚‹å‰ã«ã€ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

- iOSãƒ‡ãƒã‚¤ã‚¹ã«[Echobellã‚¢ãƒ—ãƒª](https://apps.apple.com/app/id6743597198)ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨
- æœ‰åŠ¹ãªEchobellãƒãƒ£ãƒ³ãƒãƒ«ãŒã‚ã‚‹ã“ã¨ï¼ˆã¾ã ã®å ´åˆã¯ã‚¢ãƒ—ãƒªã§ä½œæˆã—ã¦ãã ã•ã„ï¼‰
- Home Assistantã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒç¨¼åƒã—ã¦ã„ã‚‹ã“ã¨ï¼ˆãƒãƒ¼ã‚¸ãƒ§ãƒ³2023.1ä»¥é™ã‚’æ¨å¥¨ï¼‰
- Home Assistantã®è¨­å®šã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©ãŒã‚ã‚‹ã“ã¨

## æ–¹æ³•1: Webhookãƒˆãƒªã‚¬ãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹ï¼ˆæ¨å¥¨ï¼‰

Webhookã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³•ã¯æœ€ã‚‚æŸ”è»Ÿæ€§ãŒé«˜ãã€ã‚«ã‚¹ã‚¿ãƒ ãƒ‡ãƒ¼ã‚¿ã®é€ä¿¡ã‚„é€šçŸ¥å†…ã§ã®[ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå¤‰æ•°](/docs/template)ã®ä½¿ç”¨ãŒå¯èƒ½ã§ã™ã€‚

### ã‚¹ãƒ†ãƒƒãƒ—1: Echobell Webhook URLã®å–å¾—

1. Echobellã‚¢ãƒ—ãƒªã‚’é–‹ãã€ãƒãƒ£ãƒ³ãƒãƒ«ã«ç§»å‹•ã—ã¾ã™
2. ãƒãƒ£ãƒ³ãƒãƒ«ã‚’ã‚¿ãƒƒãƒ—ã—ã¦è©³ç´°ã‚’è¡¨ç¤ºã—ã¾ã™
3. Triggersã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã‚ã‚‹ **Webhook URL** ã‚’æ¢ã—ã¾ã™
4. URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š`https://hook.echobell.one/t/YOUR_TOKEN`

### ã‚¹ãƒ†ãƒƒãƒ—2: Home Assistantã‚ªãƒ¼ãƒˆãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®ä½œæˆ

Home Assistantã§ã¯ã€`rest_command`ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ç”¨ã—ã¦Echobellé€šçŸ¥ã‚’ãƒˆãƒªã‚¬ãƒ¼ã§ãã¾ã™ã€‚ã¾ãšã€`configuration.yaml`ã«RESTã‚³ãƒãƒ³ãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ï¼š

```yaml
rest_command:
  echobell_notify:
    url: "https://hook.echobell.one/t/YOUR_TOKEN"
    method: POST
    content_type: "application/json"
    payload: '{"title": "{{ title }}", "message": "{{ message }}"}'
```

`YOUR_TOKEN`ã‚’å®Ÿéš›ã®Echobell Webhookãƒˆãƒ¼ã‚¯ãƒ³ã«ç½®ãæ›ãˆã¦ãã ã•ã„ã€‚

è¿½åŠ å¾Œã€Home Assistantã‚’å†èµ·å‹•ã—ã¦æ–°ã—ã„è¨­å®šã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚

### ã‚¹ãƒ†ãƒƒãƒ—3: ã‚ªãƒ¼ãƒˆãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã§ã®ä½¿ç”¨

ã“ã‚Œã§ã€ã©ã®ã‚ªãƒ¼ãƒˆãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰ã§ã‚‚ã“ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚ä»¥ä¸‹ã¯ã€ãƒ‰ã‚¢ãŒé–‹ã„ãŸã¨ãã«é€šçŸ¥ã™ã‚‹ä¾‹ã§ã™ï¼š

```yaml
automation:
  - alias: "Door Open Alert"
    trigger:
      - platform: state
        entity_id: binary_sensor.front_door
        to: "on"
    action:
      - service: rest_command.echobell_notify
        data:
          title: "Security Alert"
          message: "Front door opened at {{ now().strftime('%H:%M') }}"
```

### ã‚¹ãƒ†ãƒƒãƒ—4: é€šçŸ¥ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®è¨­å®š

Echobellãƒãƒ£ãƒ³ãƒãƒ«ã®è¨­å®šã§ã€Webhookãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã™ã‚‹ã‚ˆã†ã«é€šçŸ¥ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’è¨­å®šã—ã¾ã™ï¼š

- **Title template**: `{{title}}`
- **Body template**: `{{message}}`

ã“ã‚Œã§ã€ã‚ªãƒ¼ãƒˆãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãŒãƒˆãƒªã‚¬ãƒ¼ã•ã‚Œã‚‹ã¨ã€ã‚«ã‚¹ã‚¿ãƒ ã‚¿ã‚¤ãƒˆãƒ«ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å«ã‚€é€šçŸ¥ãŒå±Šãã¾ã™ã€‚

## æ–¹æ³•2: RESTful Notifyãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½¿ç”¨ã™ã‚‹

ã‚ˆã‚Šçµ±åˆã•ã‚ŒãŸã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¨ã—ã¦ã€Echobellã‚’Home Assistantã®é€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆnotify serviceï¼‰ã¨ã—ã¦è¨­å®šã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

### è¨­å®š

`configuration.yaml`ã«ä»¥ä¸‹ã‚’è¿½åŠ ã—ã¾ã™ï¼š

```yaml
notify:
  - name: echobell
    platform: rest
    resource: https://hook.echobell.one/t/YOUR_TOKEN
    method: POST_JSON
    data:
      title: "{{ title }}"
      message: "{{ message }}"
```

`YOUR_TOKEN`ã‚’Echobell Webhookãƒˆãƒ¼ã‚¯ãƒ³ã«ç½®ãæ›ãˆã€Home Assistantã‚’å†èµ·å‹•ã—ã¦ãã ã•ã„ã€‚

### Notifyã‚µãƒ¼ãƒ“ã‚¹ã®ä½¿ç”¨

ã“ã‚Œã§ã€ä»–ã®é€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹ã¨åŒæ§˜ã«Echobellã‚’ä½¿ç”¨ã§ãã¾ã™ï¼š

```yaml
automation:
  - alias: "Low Battery Alert"
    trigger:
      - platform: numeric_state
        entity_id: sensor.phone_battery
        below: 20
    action:
      - service: notify.echobell
        data:
          title: "Low Battery Warning"
          message: "Phone battery is at {{ states('sensor.phone_battery') }}%"
```

## é«˜åº¦ãªãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹

### ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ã‚¢ãƒ©ãƒ¼ãƒˆã«ã‚ˆã‚‹æ¸©åº¦ç›£è¦–

[é€šçŸ¥ã‚¿ã‚¤ãƒ—](/docs/notification)ã‚’ä½¿ç”¨ã—ã¦ã€é‡è¦ãªæ¸©åº¦ã‚¢ãƒ©ãƒ¼ãƒˆã‚’é›»è©±ç€ä¿¡ã¨ã—ã¦é€ä¿¡ã—ã¾ã™ï¼š

```yaml
rest_command:
  echobell_critical:
    url: "https://hook.echobell.one/t/YOUR_TOKEN"
    method: POST
    content_type: "application/json"
    payload: '{"temperature": "{{ temperature }}", "location": "{{ location }}", "severity": "critical"}'
```

Echobellãƒãƒ£ãƒ³ãƒãƒ«ã§ã€[é€šçŸ¥ã‚¿ã‚¤ãƒ—](/docs/notification)ã‚’ã€ŒCallingã€ã«è¨­å®šã—ã€ä»¥ä¸‹ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ã¾ã™ï¼š

- **Title**: `Critical Temperature Alert`
- **Body**: `{{location}} temperature is {{temperature}}Â°C - Immediate attention required!`

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚·ã‚¹ãƒ†ãƒ ã¨ã®çµ±åˆ

åŒ…æ‹¬çš„ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ã‚’è¨­å®šã—ã¾ã™ï¼š

```yaml
automation:
  - alias: "Security Breach Detection"
    trigger:
      - platform: state
        entity_id:
          - binary_sensor.motion_detector_1
          - binary_sensor.motion_detector_2
          - binary_sensor.window_sensor
        to: "on"
    condition:
      - condition: state
        entity_id: alarm_control_panel.home_alarm
        state: "armed_away"
    action:
      - service: rest_command.echobell_notify
        data:
          title: "ğŸš¨ Security Alert"
          message: "{{ trigger.to_state.attributes.friendly_name }} detected activity while system armed"
          sensor: "{{ trigger.entity_id }}"
          timestamp: "{{ now().isoformat() }}"
```

### ã‚¹ãƒãƒ¼ãƒˆå®¶é›»ã®é€šçŸ¥

å®¶é›»ã®ã‚µã‚¤ã‚¯ãƒ«ã‚’ç›£è¦–ã—ã€å®Œäº†æ™‚ã«é€šçŸ¥ã‚’å—ã‘å–ã‚Šã¾ã™ï¼š

```yaml
automation:
  - alias: "Washing Machine Complete"
    trigger:
      - platform: state
        entity_id: sensor.washing_machine_power
        to: "0"
        for:
          minutes: 3
    action:
      - service: notify.echobell
        data:
          title: "Washing Machine Done"
          message: "Your laundry is ready to be moved to the dryer"
```

### ç’°å¢ƒãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°

ç©ºæ°—è³ªã€æ¹¿åº¦ã€ãã®ä»–ã®ç’°å¢ƒè¦å› ã‚’è¿½è·¡ã—ã¾ã™ï¼š

```yaml
automation:
  - alias: "High CO2 Alert"
    trigger:
      - platform: numeric_state
        entity_id: sensor.living_room_co2
        above: 1000
    action:
      - service: rest_command.echobell_notify
        data:
          title: "Air Quality Warning"
          message: "CO2 level in living room is {{ states('sensor.living_room_co2') }} ppm. Consider ventilating."
```

## æ¡ä»¶ã‚’ä½¿ç”¨ã—ãŸã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°

[Echobellã®æ¡ä»¶](/docs/conditions)ã‚’ä½¿ç”¨ã—ã¦ã€ç‰¹å®šã®åŸºæº–ã«åŸºã¥ã„ã¦é€šçŸ¥ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã§ãã¾ã™ã€‚ä¾‹ãˆã°ã€ç‰¹å®šã®æ™‚é–“å¸¯ã‚„å€¤ãŒé–¾å€¤ã‚’è¶…ãˆãŸå ´åˆã®ã¿é€šçŸ¥ã™ã‚‹ãªã©ã§ã™ï¼š

Echobellãƒãƒ£ãƒ³ãƒãƒ«ã§æ¡ä»¶ã‚’è¨­å®šã—ã¾ã™ï¼š
```
severity == "critical" || (hour >= 22 || hour <= 7)
```

ã“ã‚Œã¯ã€é‡è¦åº¦ãŒã€Œcriticalã€ã§ã‚ã‚‹ã‹ã€ã¾ãŸã¯å¤œé–“ï¼ˆåˆå¾Œ10æ™‚ã‹ã‚‰åˆå‰7æ™‚ï¼‰ã§ã‚ã‚‹å ´åˆã«ã®ã¿é€šçŸ¥ã‚’é€ä¿¡ã—ã¾ã™ã€‚

Home Assistantã®ã‚ªãƒ¼ãƒˆãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã«ã€é–¢é€£ãƒ‡ãƒ¼ã‚¿ã‚’å«ã‚ã¾ã™ï¼š

```yaml
action:
  - service: rest_command.echobell_notify
    data:
      title: "Temperature Alert"
      message: "Freezer temperature: {{ states('sensor.freezer_temp') }}Â°C"
      severity: "{% if states('sensor.freezer_temp') | float > -10 %}critical{% else %}normal{% endif %}"
      hour: "{{ now().hour }}"
```

## ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ã®é€ä¿¡

Home Assistantã®ä»»æ„ã®ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’Echobellé€šçŸ¥ã«æ¸¡ã™ã“ã¨ãŒã§ãã¾ã™ï¼š

```yaml
rest_command:
  echobell_sensor_update:
    url: "https://hook.echobell.one/t/YOUR_TOKEN"
    method: POST
    content_type: "application/json"
    payload: >
      {
        "sensor_name": "{{ sensor_name }}",
        "current_value": "{{ current_value }}",
        "unit": "{{ unit }}",
        "state": "{{ state }}",
        "timestamp": "{{ timestamp }}"
      }
```

## HTTPãƒ˜ãƒƒãƒ€ãƒ¼ã®å‡¦ç†

Echobellã¯Webhookãƒªã‚¯ã‚¨ã‚¹ãƒˆã‹ã‚‰HTTPãƒ˜ãƒƒãƒ€ãƒ¼ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚ã“ã‚Œã¯èªè¨¼ã‚„è¿½è·¡ã«å½¹ç«‹ã¡ã¾ã™ï¼š

```yaml
rest_command:
  echobell_with_headers:
    url: "https://hook.echobell.one/t/YOUR_TOKEN"
    method: POST
    headers:
      X-Home-Assistant-Instance: "{{ instance_name }}"
      X-Automation-ID: "{{ automation_id }}"
    content_type: "application/json"
    payload: '{"message": "{{ message }}"}'
```

Echobellãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ãƒ˜ãƒƒãƒ€ãƒ¼ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ï¼š
```
{{header["x-home-assistant-instance"]}}
```

## ãƒ‡ãƒãƒƒã‚°ã¨ãƒ†ã‚¹ãƒˆ

### Webhookã®ãƒ†ã‚¹ãƒˆ

Home Assistantã®ã€Œé–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã€â†’ã€Œã‚µãƒ¼ãƒ“ã‚¹ã€ã‚’ä½¿ç”¨ã—ã¦è¨­å®šã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ï¼š

1. `rest_command.echobell_notify` ã‚’é¸æŠã—ã¾ã™
2. ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã—ã¾ã™ï¼š
```yaml
title: "Test Notification"
message: "This is a test from Home Assistant"
```
3. ã€Œã‚µãƒ¼ãƒ“ã‚¹ã‚’å‘¼ã³å‡ºã™ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™
4. Echobellã‚¢ãƒ—ãƒªã§é€šçŸ¥ã‚’ç¢ºèªã—ã¾ã™

### Home Assistantãƒ­ã‚°ã®ç¢ºèª

é€šçŸ¥ãŒå±Šã‹ãªã„å ´åˆã¯ã€Home Assistantã®ãƒ­ã‚°ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

```bash
# Home Assistantã§ä»¥ä¸‹ã«ç§»å‹•:
è¨­å®š â†’ ã‚·ã‚¹ãƒ†ãƒ  â†’ ãƒ­ã‚°

# ã¾ãŸã¯ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª:
config/home-assistant.log
```

`rest_command`ã‚„`hook.echobell.one`ã¸ã®HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã«é–¢é€£ã™ã‚‹ã‚¨ãƒ©ãƒ¼ã‚’æ¢ã—ã¦ãã ã•ã„ã€‚

### Webhook URLã®ç¢ºèª

Webhook URLãŒæ­£ã—ã„ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š
- `https://hook.echobell.one/t/` ã§å§‹ã¾ã£ã¦ã„ã‚‹ã“ã¨
- ãƒˆãƒ¼ã‚¯ãƒ³ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã“ã¨
- ä½™åˆ†ãªã‚¹ãƒšãƒ¼ã‚¹ã‚„æ–‡å­—ãŒå«ã¾ã‚Œã¦ã„ãªã„ã“ã¨

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«é–¢ã™ã‚‹è€ƒæ…®äº‹é …

### ãƒ¬ãƒ¼ãƒˆåˆ¶é™

Echobellã®Webhookã«ã¯ã€ä¹±ç”¨ã‚’é˜²ããŸã‚ã«ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãŒè¨­ã‘ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚æ›´æ–°é »åº¦ã®é«˜ã„ã‚»ãƒ³ã‚µãƒ¼ã®å ´åˆï¼š

- ã™ã¹ã¦ã®ã‚»ãƒ³ã‚µãƒ¼æ›´æ–°ã§ãƒˆãƒªã‚¬ãƒ¼ã—ãªã„ã‚ˆã†ã«ã™ã‚‹
- ãƒˆãƒªã‚¬ãƒ¼ã§ `for` ã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒã‚¦ãƒ³ã‚¹ï¼ˆé–“å¼•ãï¼‰ã™ã‚‹ï¼š
```yaml
trigger:
  - platform: numeric_state
    entity_id: sensor.temperature
    above: 30
    for:
      minutes: 5  # é–¾å€¤ã‚’è¶…ãˆã¦5åˆ†çµŒéã—ãŸå ´åˆã®ã¿ãƒˆãƒªã‚¬ãƒ¼
```

### æ›´æ–°ã®ãƒãƒƒãƒå‡¦ç†

è¤‡æ•°ã®é–¢é€£ã‚¤ãƒ™ãƒ³ãƒˆã«ã¤ã„ã¦ã¯ã€1ã¤ã®é€šçŸ¥ã«ã¾ã¨ã‚ã‚‹ã“ã¨ã‚’æ¤œè¨ã—ã¦ãã ã•ã„ï¼š

```yaml
automation:
  - alias: "Daily Home Summary"
    trigger:
      - platform: time
        at: "09:00:00"
    action:
      - service: rest_command.echobell_notify
        data:
          title: "Morning Home Summary"
          message: >
            Temperature: {{ states('sensor.temperature') }}Â°C
            Humidity: {{ states('sensor.humidity') }}%
            Energy today: {{ states('sensor.daily_energy') }} kWh
            Windows open: {{ expand(states.binary_sensor) | selectattr('state', 'eq', 'on') | selectattr('attributes.device_class', 'eq', 'window') | list | count }}
```

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### Webhook URLã®ä¿è­·

- Webhook URLã‚’å…¬é–‹ãƒªãƒã‚¸ãƒˆãƒªã«ã‚³ãƒŸãƒƒãƒˆã—ãªã„ã§ãã ã•ã„
- æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã«ã¯Home Assistantã®secretsã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„
- Webhookãƒˆãƒ¼ã‚¯ãƒ³ã¯å®šæœŸçš„ã«ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã—ã¦ãã ã•ã„

`configuration.yaml`ã§secretsã‚’ä½¿ç”¨ã™ã‚‹å ´åˆï¼š

```yaml
# secrets.yaml
echobell_webhook: "https://hook.echobell.one/t/YOUR_TOKEN"

# configuration.yaml
rest_command:
  echobell_notify:
    url: !secret echobell_webhook
    method: POST
    content_type: "application/json"
    payload: '{"title": "{{ title }}", "message": "{{ message }}"}'
```

### æ©Ÿå¯†æƒ…å ±ã®åˆ¶é™

é€šçŸ¥ã«å«ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã«ã¯æ³¨æ„ã—ã¦ãã ã•ã„ï¼š

```yaml
# è‰¯ã„ä¾‹ - ä¸€èˆ¬çš„ãªæƒ…å ±
message: "Motion detected in living room"

# é¿ã‘ã‚‹ã¹ãä¾‹ - æ©Ÿå¯†æ€§ã®é«˜ã„è©³ç´°
message: "Security code: 1234, camera feed: http://..."
```

## ã‚ˆãã‚ã‚‹å•é¡Œã®ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### é€šçŸ¥ãŒå±Šã‹ãªã„

1. **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã®ç¢ºèª**: Home Assistantã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«æ¥ç¶šã§ãã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„
2. **Webhook URLã®ç¢ºèª**: ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å«ã‚ã¦æ…é‡ã«ã‚³ãƒ”ãƒ¼ï¼†ãƒšãƒ¼ã‚¹ãƒˆã—ã¦ãã ã•ã„
3. **Echobellã‚¢ãƒ—ãƒªã®ç¢ºèª**: ãƒãƒ£ãƒ³ãƒãƒ«ã‚’è³¼èª­ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„
4. **Home Assistantãƒ­ã‚°ã®ç¢ºèª**: HTTPã‚¨ãƒ©ãƒ¼ã‚„ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆãŒãªã„ã‹ç¢ºèªã—ã¦ãã ã•ã„

### ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼

ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒæ­£ã—ããƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œãªã„å ´åˆï¼š

1. ã€Œé–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã€â†’ã€Œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã€ã§ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ãƒ†ã‚¹ãƒˆã—ã¦ãã ã•ã„
2. Home Assistantã¨Echobellã®é–“ã§å¤‰æ•°åãŒä¸€è‡´ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„
3. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ§‹æ–‡ã®ã‚¿ã‚¤ãƒ—ãƒŸã‚¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š`{{ variable}}` ã§ã¯ãªã `{{variable}}`

### ã‚ªãƒ¼ãƒˆãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãŒãƒˆãƒªã‚¬ãƒ¼ã•ã‚Œãªã„

1. Home Assistantã§ãƒˆãƒªã‚¬ãƒ¼æ¡ä»¶ã‚’ç¢ºèªã—ã¦ãã ã•ã„
2. ã€Œé–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã€ã‹ã‚‰ã‚ªãƒ¼ãƒˆãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ‰‹å‹•ã§ãƒ†ã‚¹ãƒˆã—ã¦ãã ã•ã„
3. ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®çŠ¶æ…‹ãŒãƒˆãƒªã‚¬ãƒ¼è¨­å®šã¨ä¸€è‡´ã—ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„
4. ãƒ‡ãƒãƒƒã‚°ã®ãŸã‚ã«ã‚ªãƒ¼ãƒˆãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„

## ä¾‹ï¼šå®Œå…¨ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚·ã‚¹ãƒ†ãƒ è¨­å®š

è¤‡æ•°ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚»ãƒ³ã‚µãƒ¼ã‚’çµ±åˆã—ãŸåŒ…æ‹¬çš„ãªä¾‹ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ï¼š

```yaml
# configuration.yaml
rest_command:
  echobell_security:
    url: !secret echobell_security_webhook
    method: POST
    content_type: "application/json"
    payload: >
      {
        "event_type": "{{ event_type }}",
        "location": "{{ location }}",
        "sensor": "{{ sensor }}",
        "timestamp": "{{ timestamp }}",
        "alarm_state": "{{ alarm_state }}"
      }

# automations.yaml
- alias: "Security Event Handler"
  trigger:
    - platform: state
      entity_id:
        - binary_sensor.front_door
        - binary_sensor.back_door
        - binary_sensor.garage_door
        - binary_sensor.motion_hallway
        - binary_sensor.motion_living_room
      to: "on"
  action:
    - service: rest_command.echobell_security
      data:
        event_type: "{{ 'door' if 'door' in trigger.entity_id else 'motion' }}"
        location: "{{ trigger.to_state.attributes.friendly_name }}"
        sensor: "{{ trigger.entity_id }}"
        timestamp: "{{ now().strftime('%Y-%m-%d %H:%M:%S') }}"
        alarm_state: "{{ states('alarm_control_panel.home_alarm') }}"
```

Echobellã§ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’è¨­å®šã—ã¾ã™ï¼š
- **Title**: `Security Alert: {{event_type | upper}}`
- **Body**: `{{location}} activated at {{timestamp}} (Alarm: {{alarm_state}})`

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

Echobellã¨Home Assistantã®é€£æºãŒå®Œäº†ã—ã¾ã—ãŸï¼š

- ã•ã¾ã–ã¾ãªã‚¢ãƒ©ãƒ¼ãƒˆå„ªå…ˆåº¦ã«å¯¾å¿œã™ã‚‹[é€šçŸ¥ã‚¿ã‚¤ãƒ—](/docs/notification)ã‚’èª¿ã¹ã‚‹
- é€šçŸ¥ã‚’ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆã«ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹[æ¡ä»¶](/docs/conditions)ã«ã¤ã„ã¦å­¦ã¶
- é«˜åº¦ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®ãŸã‚ã®[ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå¤‰æ•°](/docs/template)ã‚’ç¢ºèªã™ã‚‹
- æœ€é©ãªçµ±åˆã®ãŸã‚ã®[Webhookã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹](/docs/webhook)ã‚’èª­ã‚€

## é–¢é€£ãƒªã‚½ãƒ¼ã‚¹

- [Home Assistant REST Command Documentation](https://www.home-assistant.io/integrations/rest_command/)
- [Home Assistant RESTful Notify Platform](https://www.home-assistant.io/integrations/notify.rest/)
- [Echobell Webhook Documentation](/docs/webhook)
- [Echobell Template System](/docs/template)
